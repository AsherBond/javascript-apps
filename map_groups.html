<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script>
  	function find_close_groups() {
		
		//enter your api key
		var api_key = '2b2b21f3a32d2a5b4c6d3c8015746';		
		
		var zip = $('#zipcode');
		var dist = $('#distance');
		var search_field = $('#search');
		var point
		var bounds = new google.maps.LatLngBounds();
		var map = new google.maps.Map(document.getElementById("map_canvas"), {
      			zoom: 15,
      			center: new google.maps.LatLng(0,0),
      			mapTypeId: google.maps.MapTypeId.ROADMAP
    		});
	
					var ev_query = 'http://api.meetup.com/groups.json/?zip=' + zip.val() + '&radius=' + dist.val()  + '&order=ctime&desc=true&key=' + api_key + '&callback=?';
					//var ev_query = 'http://api.meetup.com/groups.json/?zip=07410&order=ctime&desc=true&key=2b2b21f3a32d2a5b4c6d3c8015746&callback=?';
					$.getJSON(ev_query, function(data) {
						if (data.status && data.status.match(/^200/) == null) {
							alert(data.status + ": " + data.details);
						} else {
        						$.each(data.results, function(i, ev) {
								point = new google.maps.LatLng(ev.lat, ev.lon);
								bounds.extend(point);
								var marker = new google.maps.Marker({ 
									position: new google.maps.LatLng(ev.lat, ev.lon), map: map, 
								});
				
        					  		google.maps.event.addListener(marker, 'click', function() {
	        				    			var link = '<h3><a href="http://www.meetup.com/' + ev.group_urlname + '">' + ev.name + '</a></h3><img src="' +  ev.photo_url +  '" alt="" />' + '<br>' + ev.description;
	      				  	    			var city = '<p>' + ev.city + '</p>';
	      			 		     			var win = new google.maps.InfoWindow({
	      				  	      				content: link + city
	      				  	    			});
        				    				win.open(map, marker);
       	   							});
       				 			});	
      						}
					});
       		 		


		
		alert(!bounds.isEmpty());
		map.fitBounds(bounds);
	};

</script>
</head>
<body>
	<form>
	Zip Code <input type="text" id="zipcode" />
	<br>
	Distance <input type="text" id="distance" />
	<br>
	Search <input type="text" id="search" />
	<br>
	<input type="button" value="Click me!" onclick="find_close_groups()" />
	</form>
  <div id="map_canvas" style="width:75%; height:75%"></div>
</body>
</html>
